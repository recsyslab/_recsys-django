# アイテム詳細ページの作成

- `recsys_django/static/js/DetailPage.js`
- `recsys_django/static/js/ItemDetailComponen.js`
- `recsys_django/static/js/Star.js`
- `recsys_django/static/js/StarRating.js`
- `recsys_django/static/js/ReturnButton.js`

リスト1: `recsys_django/static/js/main.js`
```js
/**
 * **** **** **** **** **** **** **** ****
 * 定数
 * **** **** **** **** **** **** **** ****
 */
...（略）...
MAX_RATING = 5;

DETAIL_ENLARGE = 1.5;

DETAIL_ITEM_LEFT = 0;
DETAIL_ITEM_TOP = 0;
DETAIL_ITEM_WIDTH = ITEM_WIDTH * DETAIL_ENLARGE;
DETAIL_ITEM_HEIGHT = ITEM_HEIGHT * DETAIL_ENLARGE;

DETAIL_SLOT_LEFT = 0;
DETAIL_SLOT_TOP = DETAIL_ITEM_TOP + DETAIL_ITEM_HEIGHT + MARGIN;

DETAIL_STAR_WIDTH = 32;

DETAIL_RETURN_WIDTH = 64;
DETAIL_RETURN_LEFT = SLOT_WIDTH - DETAIL_RETURN_WIDTH - MARGIN / 2;
DETAIL_RETURN_TOP = DETAIL_SLOT_TOP + SLOT_HEIGHT + MARGIN;
```

リスト2: `recsys_django/static/js/main.js`
```js
/**
 * **** **** **** **** **** **** **** ****
 * グローバル変数
 * **** **** **** **** **** **** **** ****
 */
// ページ
let currentPage = null;         // 現在のページ
let mainPage = null;            // メインページ
let detailPage = null;          // 詳細ページ           // 追加

// Imageオブジェクト
let returnImage = null;         // 「戻る」ボタン画像    // 追加
let starImages = null;          // 星画像配列           // 追加
```

リスト3: `recsys_django/static/js/main.js`
```js
/**
 * 全体の初期化処理
 */
function init() {
    // キャンバス要素の取得
    let canvas = $('#main_canvas').get(0);
    // 描画コンテキストの取得
    let context = canvas.getContext("2d");

    // イベントリスナの追加
    canvas.addEventListener('click', onCanvasClick, false);
    canvas.addEventListener('mousemove', onCanvasMouseMove, false);
    
    /* 以下を追加 */
    // Imageオブジェクトの生成
    returnImage = new Image();
    returnImage.src = returnSrc;
    returnImage.onload = function() {
        console.log(returnImage.src + " : load completed");
    }
    starImages = new Array();
    for (let i = 0; i < starSrcs.length; i++) {
        starImages[i] = new Image();
        starImages[i].src = starSrcs[i];
        starImages[i].onload = function() {
            console.log(starImages[i].src + " : load completed");
        }
    }

    // ページの生成
    mainPage = new MainPage(canvas, context);
    detailPage = new DetailPage(canvas, context);   // 追加

    // データの初期化
    initData();
}
```

リスト4: `recsys_django/online/templates/index.html`
```js
    {# --- js --- #}
    <script type="text/javascript" src="{% static 'js/Page.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/MainPage.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/DetailPage.js' %}"></script>

    <script type="text/javascript" src="{% static 'js/Item.js' %}"></script>

    <script type="text/javascript" src="{% static 'js/Component.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/ItemComponent.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/NextButton.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/Slot.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/ReturnButton.js' %}"></script>        <!-- 追加 -->
    <script type="text/javascript" src="{% static 'js/Star.js' %}"></script>                <!-- 追加 -->
    <script type="text/javascript" src="{% static 'js/StarRating.js' %}"></script>          <!-- 追加 -->
    <script type="text/javascript" src="{% static 'js/ItemDetailComponent.js' %}"></script> <!-- 追加 -->

    <script type="text/javascript" src="{% static 'js/main.js' %}"></script>
```

リスト5: `recsys_django/online/templates/base.html`
```
        {# --- files --- #}
        <script>
            let returnSrc = "{% static 'img/return.png' %}";
            let starSrcs = new Array(
                "{% static 'img/star0.png' %}",
                "{% static 'img/star1.png' %}",
                "{% static 'img/star2.png' %}",
            );
        </script>
```
